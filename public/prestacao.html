<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Prestação de Contas — Evidências</title>
  <link rel="stylesheet" href="/styles/styles.css" />
  <!-- SheetJS para ler Excel -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body class="layout-soft-bg prestacao-page">
  <!-- ===== Topbar principal ===== -->
  <header class="header">
    <div class="header-logo">
      <img src="/assets/edge.png" alt="Edge" />
      <img src="/assets/vertex.png" alt="Vertex" style="margin-left:10px;height:40px;" />
    </div>
    <nav class="header-nav">
      <a href="/dashboard" class="nav-link">Painel de Projetos</a>
      <a href="/login" class="nav-link">Login</a>
    </nav>
  </header>

  <!-- ===== Subnav de Prestação (fixa) ===== -->
  <div class="subnav">
    <div class="subnav-inner">
      <div class="subnav-title">Prestação de Contas</div>
      <nav class="tabs" id="prest-tabs">
        <a class="tab active" id="tab-evidencias" href="#">Evidências</a>
        <!-- Abas serão ocultadas via JavaScript para Gerente -->
        <a class="tab" id="tab-docfin" href="#">Documentação financeira</a>
        <a class="tab" id="tab-bolsas" href="#">Gerenciamento de Bolsas</a>
      </nav>
    </div>
  </div>

  <main class="container">
    <!-- Card 1: Cabeçalho + Cronograma -->
    <section class="card block">
      <h1 class="block-title">Evidências</h1>

      <div class="project-head">
        <div><strong>Projeto:</strong> <span id="p-nome">—</span></div>
        <div><strong>Código:</strong> <span id="p-codigo">—</span></div>
        <div><strong>Gerente:</strong> <span id="p-gerente">—</span></div>
        <div><strong>Status:</strong> <span id="p-status">—</span></div>
      </div>

      <div class="divider"></div>

      <div class="form-row">
        <label class="field">
          <span>Cronograma de execução — Início</span>
          <input id="cron-inicio" type="date" />
        </label>

        <label class="field">
          <span>Cronograma de execução — Fim</span>
          <input id="cron-fim" type="date" />
        </label>

        <label class="field">
          <span>Número de metas físicas</span>
          <input id="qtd-metas" type="number" min="0" step="1" placeholder="Ex.: 12" />
        </label>
      </div>
    </section>

    <!-- Card 2: Upload + Tabela -->
    <section class="card block">
      <h2 class="block-title">Tabela de Evidências do Projeto</h2>

      <div class="upload-box">
        <div class="muted"><strong>Upload do cronograma (Excel)</strong> — Formatos aceitos: <code>.xlsx</code>, <code>.xls</code>, <code>.csv</code>.</div>
        <label class="btn btn-light btn-upload">
          <input id="file-cronograma" type="file" accept=".xlsx,.xls,.csv" class="hidden-input" />
          Enviar cronograma
        </label>
      </div>

      <div class="table-wrap">
        <table class="table" id="tbl-evidencias">
          <thead>
            <tr>
              <th style="min-width:180px;">Etapa</th>
              <th style="max-width: width 200px;">Nome da Evidência</th>
              <th>Mês</th>
              <th>Data de entrega</th>
              <th>Upload de evidência</th>
              <th>Status</th>
              <th>Ações</th>
              <!-- Texto será ajustado via JavaScript -->
              <th id="th-notificar">Notificar o Gerente</th>
            </tr>
          </thead>
          <tbody><!-- linhas via JS --></tbody>
        </table>
      </div>
    </section>
  </main>

  <script src="/evidencias.js"></script>
  
<script type="module" src="/scripts.js"></script>
<script type="module">
  import { getAuth, logout } from "/scripts.js";
  const me = getAuth();
  document.querySelector("#userName")?.textContent = me?.name || "";
  document.querySelector("#logoutBtn")?.addEventListener("click", logout);
</script>
</body>
</html>
